generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "mysql"
  url      = env("DATABASE_URL")
}

model User {
  id       String  @id @default(uuid())
  role     String  @default("USER") @db.VarChar(255)
  email    String  @unique @db.VarChar(255)
  password String  @db.VarChar(100)

  @@map("users")
}


model Client {
  id    String @id @default(uuid())
  name  String @db.VarChar(255)
  email String @unique @db.VarChar(255)

  // transactions Transaction[]

  @@map("clients")
}

model Product {
  id      String  @id @default(uuid())
  name    String  @db.VarChar(255)
  amount  Decimal @db.Decimal(10, 2)

  transactionProducts TransactionProduct[]

  @@map("products")
}

model Gateway {
  id        String  @id @default(uuid())
  name      String  @db.VarChar(255)
  is_active Boolean @default(true)
  priority  Int     @default(0)

  // transactions Transaction[]

  @@map("gateways")
}

model Transaction {
  id                String   @id @default(uuid())
  clientId          String
  gatewayId         String
  external_id       String   @db.VarChar(255)
  status            String   @db.VarChar(100)
  amount            Decimal  @db.Decimal(10, 2)
  name              String   @db.VarChar(255)
  email             String   @db.VarChar(255)
  cardNumber        String   @db.VarChar(255)
  cvv               String   @db.VarChar(10)
  card_last_numbers String?  @db.VarChar(4)
  products          Json?
  createdAt         DateTime @default(now())

  // client              Client              @relation(fields: [clientId], references: [id])
  // gateway             Gateway             @relation(fields: [gatewayId], references: [id])
  // transactionProducts TransactionProduct[]

  @@map("transactions")
}




model TransactionProduct {
  id             String   @id @default(uuid())
  transactionId  String
  productId      String
  quantity       Int

  // transaction Transaction @relation(fields: [transactionId], references: [id])
  product     Product     @relation(fields: [productId], references: [id])

  @@map("transaction_products")
}
